TEST: C (multi-target query two targets)
QUERY:
SELECT COUNT(*) FROM lineitem l JOIN orders o ON l.l_orderkey=o.o_orderkey;

ENABLED POLICIES:
orders : orders.o_custkey = customer.c_custkey AND (customer.c_mktsegment = 'AUTOMOBILE' OR customer.c_mktsegment = 'HOUSEHOLD')
lineitem : lineitem.l_shipmode IN ('MAIL','SHIP')

EXPLAIN OFF (custom_filter.enabled=off):
Aggregate
  ->  Merge Join
        Merge Cond: (o.o_orderkey = l.l_orderkey)
        ->  Index Only Scan using cf_rls_k11_orders_o_orderkey_18 on orders o
        ->  Index Only Scan using cf_rls_k11_lineitem_l_orderkey_8 on lineitem l

EXPLAIN ON (custom_filter.enabled=on):
ERROR: ERROR:  custom_filter: missing artifacts: customer_code_base, customer_ctid, dict/customer/c_mktsegment, dict/lineitem/l_shipmode, lineitem_code_base, lineitem_ctid, meta/cols/customer, meta/cols/lineitem, meta/cols/orders, meta/dict_sorted/customer/c_mktsegment, meta/dict_sorted/lineitem/l_shipmode, meta/dict_type/customer/c_mktsegment, meta/dict_type/lineitem/l_shipmode, meta/join_classes, orders_code_base, orders_ctid
--- ON notices ---
NOTICE:  policy_eval: target=orders tokens=IDENT:orders.o_custkey OP:= IDENT:customer.c_custkey AND:and LPAREN:( IDENT:customer.c_mktsegment OP:= STRING:'AUTOMOBILE' OR:or IDENT:customer.c_mktsegment OP:= STRING:'HOUSEHOLD' RPAREN:)
NOTICE:  policy_eval: target=lineitem tokens=IDENT:lineitem.l_shipmode OP:in LPAREN:( STRING:'MAIL' COMMA:, STRING:'SHIP' RPAREN:)
NOTICE:  policy_eval: target=lineitem join_classes=[]
NOTICE:  policy_eval: target=orders join_classes=[0]
NOTICE:  policy_eval: policy[1] target=orders expr=orders.o_custkey = customer.c_custkey AND (customer.c_mktsegment = 'AUTOMOBILE' OR customer.c_mktsegment = 'HOUSEHOLD') ast=y4 and (y1 or y2)
NOTICE:  policy_eval: policy[2] target=lineitem expr=lineitem.l_shipmode IN ('MAIL','SHIP') ast=y3
NOTICE:  policy_eval: atom y1 = const:customer.c_mktsegment|=|AUTOMOBILE
NOTICE:  policy_eval: atom y2 = const:customer.c_mktsegment|=|HOUSEHOLD
NOTICE:  policy_eval: atom y3 = const:lineitem.l_shipmode|in|MAIL,SHIP
NOTICE:  policy_eval: atom y4 = join:customer.c_custkey=orders.o_custkey
NOTICE:  policy_eval: combined_ast target=lineitem ast=y3
NOTICE:  policy_eval: combined_ast target=orders ast=y4 and (y1 or y2)
NOTICE:  policy_eval: closure_count=3
NOTICE:  policy_eval: target=orders tokens=IDENT:orders.o_custkey OP:= IDENT:customer.c_custkey AND:and LPAREN:( IDENT:customer.c_mktsegment OP:= STRING:'AUTOMOBILE' OR:or IDENT:customer.c_mktsegment OP:= STRING:'HOUSEHOLD' RPAREN:)
NOTICE:  policy_eval: target=lineitem tokens=IDENT:lineitem.l_shipmode OP:in LPAREN:( STRING:'MAIL' COMMA:, STRING:'SHIP' RPAREN:)
NOTICE:  policy_eval: target=lineitem join_classes=[]
NOTICE:  policy_eval: target=orders join_classes=[0]
NOTICE:  policy_eval: policy[1] target=orders expr=orders.o_custkey = customer.c_custkey AND (customer.c_mktsegment = 'AUTOMOBILE' OR customer.c_mktsegment = 'HOUSEHOLD') ast=y4 and (y1 or y2)
NOTICE:  policy_eval: policy[2] target=lineitem expr=lineitem.l_shipmode IN ('MAIL','SHIP') ast=y3
NOTICE:  policy_eval: atom y1 = const:customer.c_mktsegment|=|AUTOMOBILE
NOTICE:  policy_eval: atom y2 = const:customer.c_mktsegment|=|HOUSEHOLD
NOTICE:  policy_eval: atom y3 = const:lineitem.l_shipmode|in|MAIL,SHIP
NOTICE:  policy_eval: atom y4 = join:customer.c_custkey=orders.o_custkey
NOTICE:  policy_eval: combined_ast target=lineitem ast=y3
NOTICE:  policy_eval: combined_ast target=orders ast=y4 and (y1 or y2)
NOTICE:  policy_eval: closure_count=3

OURS EXECUTION:
ERROR: ERROR:  custom_filter: missing artifacts: customer_code_base, customer_ctid, dict/customer/c_mktsegment, dict/lineitem/l_shipmode, lineitem_code_base, lineitem_ctid, meta/cols/customer, meta/cols/lineitem, meta/cols/orders, meta/dict_sorted/customer/c_mktsegment, meta/dict_sorted/lineitem/l_shipmode, meta/dict_type/customer/c_mktsegment, meta/dict_type/lineitem/l_shipmode, meta/join_classes, orders_code_base, orders_ctid
--- Ours notices ---
NOTICE:  policy_eval: target=orders tokens=IDENT:orders.o_custkey OP:= IDENT:customer.c_custkey AND:and LPAREN:( IDENT:customer.c_mktsegment OP:= STRING:'AUTOMOBILE' OR:or IDENT:customer.c_mktsegment OP:= STRING:'HOUSEHOLD' RPAREN:)
NOTICE:  policy_eval: target=lineitem tokens=IDENT:lineitem.l_shipmode OP:in LPAREN:( STRING:'MAIL' COMMA:, STRING:'SHIP' RPAREN:)
NOTICE:  policy_eval: target=lineitem join_classes=[]
NOTICE:  policy_eval: target=orders join_classes=[0]
NOTICE:  policy_eval: policy[1] target=orders expr=orders.o_custkey = customer.c_custkey AND (customer.c_mktsegment = 'AUTOMOBILE' OR customer.c_mktsegment = 'HOUSEHOLD') ast=y4 and (y1 or y2)
NOTICE:  policy_eval: policy[2] target=lineitem expr=lineitem.l_shipmode IN ('MAIL','SHIP') ast=y3
NOTICE:  policy_eval: atom y1 = const:customer.c_mktsegment|=|AUTOMOBILE
NOTICE:  policy_eval: atom y2 = const:customer.c_mktsegment|=|HOUSEHOLD
NOTICE:  policy_eval: atom y3 = const:lineitem.l_shipmode|in|MAIL,SHIP
NOTICE:  policy_eval: atom y4 = join:customer.c_custkey=orders.o_custkey
NOTICE:  policy_eval: combined_ast target=lineitem ast=y3
NOTICE:  policy_eval: combined_ast target=orders ast=y4 and (y1 or y2)
NOTICE:  policy_eval: closure_count=3
NOTICE:  policy_eval: target=orders tokens=IDENT:orders.o_custkey OP:= IDENT:customer.c_custkey AND:and LPAREN:( IDENT:customer.c_mktsegment OP:= STRING:'AUTOMOBILE' OR:or IDENT:customer.c_mktsegment OP:= STRING:'HOUSEHOLD' RPAREN:)
NOTICE:  policy_eval: target=lineitem tokens=IDENT:lineitem.l_shipmode OP:in LPAREN:( STRING:'MAIL' COMMA:, STRING:'SHIP' RPAREN:)
NOTICE:  policy_eval: target=lineitem join_classes=[]
NOTICE:  policy_eval: target=orders join_classes=[0]
NOTICE:  policy_eval: policy[1] target=orders expr=orders.o_custkey = customer.c_custkey AND (customer.c_mktsegment = 'AUTOMOBILE' OR customer.c_mktsegment = 'HOUSEHOLD') ast=y4 and (y1 or y2)
NOTICE:  policy_eval: policy[2] target=lineitem expr=lineitem.l_shipmode IN ('MAIL','SHIP') ast=y3
NOTICE:  policy_eval: atom y1 = const:customer.c_mktsegment|=|AUTOMOBILE
NOTICE:  policy_eval: atom y2 = const:customer.c_mktsegment|=|HOUSEHOLD
NOTICE:  policy_eval: atom y3 = const:lineitem.l_shipmode|in|MAIL,SHIP
NOTICE:  policy_eval: atom y4 = join:customer.c_custkey=orders.o_custkey
NOTICE:  policy_eval: combined_ast target=lineitem ast=y3
NOTICE:  policy_eval: combined_ast target=orders ast=y4 and (y1 or y2)
NOTICE:  policy_eval: closure_count=3

GROUND TRUTH SOURCE: rls
GT COUNT: 67564
