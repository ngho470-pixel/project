TEST: B (join policy single target with closure)
QUERY:
SELECT COUNT(*) FROM orders o JOIN customer c ON o.o_custkey=c.c_custkey;

ENABLED POLICIES:
orders : orders.o_custkey = customer.c_custkey AND (customer.c_mktsegment = 'AUTOMOBILE' OR customer.c_mktsegment = 'HOUSEHOLD')

EXPLAIN OFF (custom_filter.enabled=off):
Aggregate
  ->  Merge Join
        Merge Cond: (c.c_custkey = o.o_custkey)
        ->  Index Only Scan using cf_rls_k11_customer_c_custkey_2 on customer c
        ->  Index Only Scan using cf_rls_k11_orders_o_custkey_17 on orders o

EXPLAIN ON (custom_filter.enabled=on):
ERROR: ERROR:  custom_filter: missing artifacts: customer_code_base, customer_ctid, dict/customer/c_mktsegment, meta/cols/customer, meta/cols/orders, meta/dict_sorted/customer/c_mktsegment, meta/dict_type/customer/c_mktsegment, meta/join_classes, orders_code_base, orders_ctid
--- ON notices ---
NOTICE:  policy_eval: target=orders tokens=IDENT:orders.o_custkey OP:= IDENT:customer.c_custkey AND:and LPAREN:( IDENT:customer.c_mktsegment OP:= STRING:'AUTOMOBILE' OR:or IDENT:customer.c_mktsegment OP:= STRING:'HOUSEHOLD' RPAREN:)
NOTICE:  policy_eval: target=orders join_classes=[0]
NOTICE:  policy_eval: policy[1] target=orders expr=orders.o_custkey = customer.c_custkey AND (customer.c_mktsegment = 'AUTOMOBILE' OR customer.c_mktsegment = 'HOUSEHOLD') ast=y3 and (y1 or y2)
NOTICE:  policy_eval: atom y1 = const:customer.c_mktsegment|=|AUTOMOBILE
NOTICE:  policy_eval: atom y2 = const:customer.c_mktsegment|=|HOUSEHOLD
NOTICE:  policy_eval: atom y3 = join:customer.c_custkey=orders.o_custkey
NOTICE:  policy_eval: combined_ast target=orders ast=y3 and (y1 or y2)
NOTICE:  policy_eval: closure_count=2
NOTICE:  policy_eval: target=orders tokens=IDENT:orders.o_custkey OP:= IDENT:customer.c_custkey AND:and LPAREN:( IDENT:customer.c_mktsegment OP:= STRING:'AUTOMOBILE' OR:or IDENT:customer.c_mktsegment OP:= STRING:'HOUSEHOLD' RPAREN:)
NOTICE:  policy_eval: target=orders join_classes=[0]
NOTICE:  policy_eval: policy[1] target=orders expr=orders.o_custkey = customer.c_custkey AND (customer.c_mktsegment = 'AUTOMOBILE' OR customer.c_mktsegment = 'HOUSEHOLD') ast=y3 and (y1 or y2)
NOTICE:  policy_eval: atom y1 = const:customer.c_mktsegment|=|AUTOMOBILE
NOTICE:  policy_eval: atom y2 = const:customer.c_mktsegment|=|HOUSEHOLD
NOTICE:  policy_eval: atom y3 = join:customer.c_custkey=orders.o_custkey
NOTICE:  policy_eval: combined_ast target=orders ast=y3 and (y1 or y2)
NOTICE:  policy_eval: closure_count=2

OURS EXECUTION:
ERROR: ERROR:  custom_filter: missing artifacts: customer_code_base, customer_ctid, dict/customer/c_mktsegment, meta/cols/customer, meta/cols/orders, meta/dict_sorted/customer/c_mktsegment, meta/dict_type/customer/c_mktsegment, meta/join_classes, orders_code_base, orders_ctid
--- Ours notices ---
NOTICE:  policy_eval: target=orders tokens=IDENT:orders.o_custkey OP:= IDENT:customer.c_custkey AND:and LPAREN:( IDENT:customer.c_mktsegment OP:= STRING:'AUTOMOBILE' OR:or IDENT:customer.c_mktsegment OP:= STRING:'HOUSEHOLD' RPAREN:)
NOTICE:  policy_eval: target=orders join_classes=[0]
NOTICE:  policy_eval: policy[1] target=orders expr=orders.o_custkey = customer.c_custkey AND (customer.c_mktsegment = 'AUTOMOBILE' OR customer.c_mktsegment = 'HOUSEHOLD') ast=y3 and (y1 or y2)
NOTICE:  policy_eval: atom y1 = const:customer.c_mktsegment|=|AUTOMOBILE
NOTICE:  policy_eval: atom y2 = const:customer.c_mktsegment|=|HOUSEHOLD
NOTICE:  policy_eval: atom y3 = join:customer.c_custkey=orders.o_custkey
NOTICE:  policy_eval: combined_ast target=orders ast=y3 and (y1 or y2)
NOTICE:  policy_eval: closure_count=2
NOTICE:  policy_eval: target=orders tokens=IDENT:orders.o_custkey OP:= IDENT:customer.c_custkey AND:and LPAREN:( IDENT:customer.c_mktsegment OP:= STRING:'AUTOMOBILE' OR:or IDENT:customer.c_mktsegment OP:= STRING:'HOUSEHOLD' RPAREN:)
NOTICE:  policy_eval: target=orders join_classes=[0]
NOTICE:  policy_eval: policy[1] target=orders expr=orders.o_custkey = customer.c_custkey AND (customer.c_mktsegment = 'AUTOMOBILE' OR customer.c_mktsegment = 'HOUSEHOLD') ast=y3 and (y1 or y2)
NOTICE:  policy_eval: atom y1 = const:customer.c_mktsegment|=|AUTOMOBILE
NOTICE:  policy_eval: atom y2 = const:customer.c_mktsegment|=|HOUSEHOLD
NOTICE:  policy_eval: atom y3 = join:customer.c_custkey=orders.o_custkey
NOTICE:  policy_eval: combined_ast target=orders ast=y3 and (y1 or y2)
NOTICE:  policy_eval: closure_count=2

GROUND TRUTH SOURCE: rls
GT COUNT: 59321
