QUERY:
SELECT COUNT(*) FROM orders o JOIN customer c ON o.o_custkey=c.c_custkey;

EXPLAIN OFF:
Aggregate
  ->  Hash Join
        Hash Cond: (o.o_custkey = c.c_custkey)
        ->  Index Only Scan using idx_orders_custkey on orders o
        ->  Hash
              ->  Seq Scan on customer c

EXPLAIN ON:
Aggregate
  ->  Hash Join
        Hash Cond: (o.o_custkey = c.c_custkey)
        ->  Seq Scan on orders o
        ->  Hash
              ->  Custom Scan (custom_filter) on customer c
                    custom_filter: 
                    ->  Seq Scan on customer c

--- CONTRACT NOTICES ---
NOTICE:  policy_contract: offset const:customer.c_phone = 5 stride=6
NOTICE:  policy_contract: atom y1 type=COL_CONST col=customer.c_acctbal op=3 join_class=-1 dict=dict/customer/c_acctbal dict_present=1 eval=range_evaluated vals=[7000] toks=[-1]
NOTICE:  policy_contract: atom y2 type=COL_CONST col=customer.c_acctbal op=2 join_class=-1 dict=dict/customer/c_acctbal dict_present=1 eval=range_evaluated vals=[9000] toks=[-1]
NOTICE:  policy_contract: atom y3 type=COL_CONST col=customer.c_acctbal op=5 join_class=-1 dict=dict/customer/c_acctbal dict_present=1 eval=range_evaluated vals=[500] toks=[-1]
NOTICE:  policy_contract: atom y4 type=COL_CONST col=customer.c_acctbal op=4 join_class=-1 dict=dict/customer/c_acctbal dict_present=1 eval=range_evaluated vals=[0] toks=[-1]
NOTICE:  policy_contract: atom y5 type=COL_CONST col=customer.c_acctbal op=4 join_class=-1 dict=dict/customer/c_acctbal dict_present=1 eval=range_evaluated vals=[1000] toks=[-1]
NOTICE:  policy_contract: atom y6 type=COL_CONST col=customer.c_acctbal op=4 join_class=-1 dict=dict/customer/c_acctbal dict_present=1 eval=range_evaluated vals=[500] toks=[-1]
NOTICE:  policy_contract: atom y7 type=COL_CONST col=customer.c_mktsegment op=0 join_class=-1 dict=dict/customer/c_mktsegment dict_present=1 eval=exact vals=[AUTOMOBILE] toks=[0]
NOTICE:  policy_contract: atom y8 type=COL_CONST col=customer.c_mktsegment op=0 join_class=-1 dict=dict/customer/c_mktsegment dict_present=1 eval=exact vals=[BUILDING] toks=[1]
NOTICE:  policy_contract: atom y9 type=COL_CONST col=customer.c_mktsegment op=0 join_class=-1 dict=dict/customer/c_mktsegment dict_present=1 eval=exact vals=[FURNITURE] toks=[2]
NOTICE:  policy_contract: atom y10 type=COL_CONST col=customer.c_mktsegment op=0 join_class=-1 dict=dict/customer/c_mktsegment dict_present=1 eval=exact vals=[HOUSEHOLD] toks=[3]
NOTICE:  policy_contract: atom y11 type=COL_CONST col=customer.c_mktsegment op=0 join_class=-1 dict=dict/customer/c_mktsegment dict_present=1 eval=exact vals=[MACHINERY] toks=[4]
NOTICE:  policy_contract: atom y12 type=COL_CONST col=customer.c_name op=7 join_class=-1 dict=dict/customer/c_name dict_present=1 eval=prefix_evaluated vals=[Customer%] toks=[-1]
NOTICE:  policy_contract: atom y13 type=COL_CONST col=customer.c_nationkey op=2 join_class=-1 dict=dict/customer/c_nationkey dict_present=1 eval=range_evaluated vals=[10] toks=[-1]
NOTICE:  policy_contract: atom y14 type=COL_CONST col=customer.c_nationkey op=6 join_class=-1 dict=dict/customer/c_nationkey dict_present=1 eval=exact vals=[1,3,5,7] toks=[1,3,5,7]
NOTICE:  policy_contract: atom y15 type=COL_CONST col=customer.c_phone op=7 join_class=-1 dict=dict/customer/c_phone dict_present=1 eval=prefix_evaluated vals=[1%] toks=[-1]
NOTICE:  policy_contract: atom y16 type=COL_CONST col=customer.c_phone op=7 join_class=-1 dict=dict/customer/c_phone dict_present=1 eval=prefix_evaluated vals=[2%] toks=[-1]
NOTICE:  policy_contract: atom y17 type=COL_CONST col=customer.c_phone op=7 join_class=-1 dict=dict/customer/c_phone dict_present=1 eval=prefix_evaluated vals=[3%] toks=[-1]
NOTICE:  policy_contract: AST(customer)=((((customer.c_mktsegment = 'AUTOMOBILE' AND customer.c_acctbal > 0) OR (customer.c_mktsegment = 'FURNITURE' AND customer.c_acctbal > 500)) OR (customer.c_mktsegment = 'BUILDING' AND customer.c_acctbal > 1000)) AND customer.c_nationkey IN (1,3,5,7))
NOTICE:  policy: load_ms=1.981
NOTICE:  policy: bundle_eval target=customer bundle_id=5 uses_atoms=7
NOTICE:  policy: local_bins table=customer atoms=7 bins=120
NOTICE:  policy: local_ms table=customer stamp=0.000 bin=0.000 eval=1.057 fill=0.082
NOTICE:  policy: local_eval table=customer sat_calls=32 cache_hits=88
NOTICE:  policy: allow_customer count = 1244 / 15000
NOTICE:  policy: total_ms=6.033
NOTICE:  policy_profile: bundle=5 target=customer K=0 query= local={customer:atoms=7,bins=120,sat=32,hits=88,ms=0.000/0.000/1.057/0.082,total_ms=1.139} prop={iter=0,ms=0.000,classes=[]} decode={customer:1244/15000,ms=0.000,total_ms=0.000} total_ms=6.033
NOTICE:  custom_filter: bundle target=customer allow_count=0/15000
NOTICE:  custom_filter: final_allow_customer count=0/15000
NOTICE:  custom_filter: memctx label=ctid_blob rel=customer ptr=0x581a13cd4980 mctx=0x581a13c87080 qctx=0x581a13c87080 ok=true
NOTICE:  custom_filter: allow_customer popcount=0/15000
NOTICE:  custom_filter: ctid_map[0]=(0,1)->0
NOTICE:  custom_filter: ctid_map[1]=(0,2)->1
NOTICE:  custom_filter: ctid_map[2]=(0,3)->2
NOTICE:  custom_filter: ctid_map[3]=(0,4)->3
NOTICE:  custom_filter: ctid_map[4]=(0,5)->4
NOTICE:  custom_filter: memctx label=allow_bits rel=customer ptr=0x581a13def838 mctx=0x581a13c87080 qctx=0x581a13c87080 ok=true
NOTICE:  custom_filter: memctx label=blk_index rel=customer ptr=0x581a13df0040 mctx=0x581a13c87080 qctx=0x581a13c87080 ok=true
NOTICE:  custom_filter: memctx label=ctid_hash rel=customer ptr=0x581a13cbf720 mctx=0x581a13cbf610 qctx=0x581a13c87080 ok=true
NOTICE:  custom_filter: ctid_index_ms=0.297 rel=customer
NOTICE:  custom_filter: customer_ctid head [0,1 0,2 0,3 0,4 0,5]
NOTICE:  custom_filter: retain rel=customer allow=1875B ctid=120000B blk_index=4332B
NOTICE:  custom_filter: retain total allow=1875B ctid=120000B blk_index=4332B
NOTICE:  custom_filter: allow_bits pre_exec rel=customer count=0/15000 ptr=0x581a13def838 canary=ok mctx=0x581a13c87080 qctx=0x581a13c87080 qs=0x581a13c88b70
NOTICE:  custom_filter: scan rel=customer type=SeqScan filter=on
NOTICE:  custom_filter exec: rel=customer oid=74194 seen=0 passed=0 misses=0 mode=contract
NOTICE:  custom_filter: row validation time = 0.000 ms
NOTICE:  policy_metrics: eval_ms=0.920 artifact_load_ms=5.007 artifact_parse_ms=11.907 stamp_ms=59.032 bin_ms=1.092 local_sat_ms=2.518 prop_ms=0.000 prop_iters=0 decode_ms=0.000 ctid_map_ms=0.297 filter_ms=0.000 rows_seen=0 rows_passed=0 policy_total_ms=90.035
NOTICE:  policy_profile_query: K=0 query_id= total_ms=90.035 local_ms=63.139 prop_ms=0.000 decode_ms=0.000 sat_calls=71 cache_hits=529 closure_tables=1 filtered_targets=1
NOTICE:  policy: scan_count table=customer count=1
NOTICE:  policy_contract: atom y1 type=COL_CONST col=customer.c_acctbal op=3 join_class=-1 dict=dict/customer/c_acctbal dict_present=1 eval=range_evaluated vals=[7000] toks=[-1]
NOTICE:  policy_contract: atom y2 type=COL_CONST col=customer.c_acctbal op=2 join_class=-1 dict=dict/customer/c_acctbal dict_present=1 eval=range_evaluated vals=[9000] toks=[-1]
NOTICE:  policy_contract: atom y3 type=COL_CONST col=customer.c_acctbal op=5 join_class=-1 dict=dict/customer/c_acctbal dict_present=1 eval=range_evaluated vals=[500] toks=[-1]
NOTICE:  policy_contract: atom y4 type=COL_CONST col=customer.c_acctbal op=4 join_class=-1 dict=dict/customer/c_acctbal dict_present=1 eval=range_evaluated vals=[0] toks=[-1]
NOTICE:  policy_contract: atom y5 type=COL_CONST col=customer.c_acctbal op=4 join_class=-1 dict=dict/customer/c_acctbal dict_present=1 eval=range_evaluated vals=[1000] toks=[-1]
NOTICE:  policy_contract: atom y6 type=COL_CONST col=customer.c_acctbal op=4 join_class=-1 dict=dict/customer/c_acctbal dict_present=1 eval=range_evaluated vals=[500] toks=[-1]
NOTICE:  policy_contract: atom y7 type=COL_CONST col=customer.c_mktsegment op=0 join_class=-1 dict=dict/customer/c_mktsegment dict_present=1 eval=exact vals=[AUTOMOBILE] toks=[0]
NOTICE:  policy_contract: atom y8 type=COL_CONST col=customer.c_mktsegment op=0 join_class=-1 dict=dict/customer/c_mktsegment dict_present=1 eval=exact vals=[BUILDING] toks=[1]
NOTICE:  policy_contract: atom y9 type=COL_CONST col=customer.c_mktsegment op=0 join_class=-1 dict=dict/customer/c_mktsegment dict_present=1 eval=exact vals=[FURNITURE] toks=[2]
NOTICE:  policy_contract: atom y10 type=COL_CONST col=customer.c_mktsegment op=0 join_class=-1 dict=dict/customer/c_mktsegment dict_present=1 eval=exact vals=[HOUSEHOLD] toks=[3]
NOTICE:  policy_contract: atom y11 type=COL_CONST col=customer.c_mktsegment op=0 join_class=-1 dict=dict/customer/c_mktsegment dict_present=1 eval=exact vals=[MACHINERY] toks=[4]
NOTICE:  policy_contract: atom y12 type=COL_CONST col=customer.c_name op=7 join_class=-1 dict=dict/customer/c_name dict_present=1 eval=prefix_evaluated vals=[Customer%] toks=[-1]
NOTICE:  policy_contract: atom y13 type=COL_CONST col=customer.c_nationkey op=2 join_class=-1 dict=dict/customer/c_nationkey dict_present=1 eval=range_evaluated vals=[10] toks=[-1]
NOTICE:  policy_contract: atom y14 type=COL_CONST col=customer.c_nationkey op=6 join_class=-1 dict=dict/customer/c_nationkey dict_present=1 eval=exact vals=[1,3,5,7] toks=[1,3,5,7]
NOTICE:  policy_contract: atom y15 type=COL_CONST col=customer.c_phone op=7 join_class=-1 dict=dict/customer/c_phone dict_present=1 eval=prefix_evaluated vals=[1%] toks=[-1]
NOTICE:  policy_contract: atom y16 type=COL_CONST col=customer.c_phone op=7 join_class=-1 dict=dict/customer/c_phone dict_present=1 eval=prefix_evaluated vals=[2%] toks=[-1]
NOTICE:  policy_contract: atom y17 type=COL_CONST col=customer.c_phone op=7 join_class=-1 dict=dict/customer/c_phone dict_present=1 eval=prefix_evaluated vals=[3%] toks=[-1]
NOTICE:  policy_contract: AST(customer)=((((customer.c_mktsegment = 'AUTOMOBILE' AND customer.c_acctbal > 0) OR (customer.c_mktsegment = 'FURNITURE' AND customer.c_acctbal > 500)) OR (customer.c_mktsegment = 'BUILDING' AND customer.c_acctbal > 1000)) AND customer.c_nationkey IN (1,3,5,7))
NOTICE:  policy: load_ms=2.018
NOTICE:  policy: bundle_eval target=customer bundle_id=5 uses_atoms=7
NOTICE:  policy: local_bins table=customer atoms=7 bins=120
NOTICE:  policy: local_ms table=customer stamp=0.000 bin=0.000 eval=1.052 fill=0.073
NOTICE:  policy: local_eval table=customer sat_calls=32 cache_hits=88
NOTICE:  policy: allow_customer count = 1244 / 15000
NOTICE:  policy: total_ms=5.995
NOTICE:  policy_profile: bundle=5 target=customer K=0 query= local={customer:atoms=7,bins=120,sat=32,hits=88,ms=0.000/0.000/1.052/0.073,total_ms=1.126} prop={iter=0,ms=0.000,classes=[]} decode={customer:1244/15000,ms=0.000,total_ms=0.000} total_ms=5.995
NOTICE:  custom_filter: bundle target=customer allow_count=0/15000
NOTICE:  custom_filter: final_allow_customer count=0/15000
NOTICE:  custom_filter: memctx label=ctid_blob rel=customer ptr=0x581a13cd36e0 mctx=0x581a13c6b6f0 qctx=0x581a13c6b6f0 ok=true
NOTICE:  custom_filter: allow_customer popcount=0/15000
NOTICE:  custom_filter: ctid_map[0]=(0,1)->0
NOTICE:  custom_filter: ctid_map[1]=(0,2)->1
NOTICE:  custom_filter: ctid_map[2]=(0,3)->2
NOTICE:  custom_filter: ctid_map[3]=(0,4)->3
NOTICE:  custom_filter: ctid_map[4]=(0,5)->4
NOTICE:  custom_filter: memctx label=allow_bits rel=customer ptr=0x581a13cb0cc0 mctx=0x581a13c6b6f0 qctx=0x581a13c6b6f0 ok=true
NOTICE:  custom_filter: memctx label=blk_index rel=customer ptr=0x581a13cb14c8 mctx=0x581a13c6b6f0 qctx=0x581a13c6b6f0 ok=true
NOTICE:  custom_filter: memctx label=ctid_hash rel=customer ptr=0x581a13ca0140 mctx=0x581a13ca0030 qctx=0x581a13c6b6f0 ok=true
NOTICE:  custom_filter: ctid_index_ms=0.297 rel=customer
NOTICE:  custom_filter: customer_ctid head [0,1 0,2 0,3 0,4 0,5]
NOTICE:  custom_filter: retain rel=customer allow=1875B ctid=120000B blk_index=4332B
NOTICE:  custom_filter: retain total allow=1875B ctid=120000B blk_index=4332B
NOTICE:  custom_filter: allow_bits pre_exec rel=customer count=0/15000 ptr=0x581a13cb0cc0 canary=ok mctx=0x581a13c6b6f0 qctx=0x581a13c6b6f0 qs=0x581a13c6d180
NOTICE:  custom_filter: scan rel=customer type=SeqScan filter=on
NOTICE:  custom_filter: tid_source rel=customer scan=SeqScan source=tts_tid
NOTICE:  custom_filter exec: rel=customer oid=74194 seen=15000 passed=0 misses=0 mode=contract
NOTICE:  custom_filter: row validation time = 1.044 ms
NOTICE:  policy_metrics: eval_ms=0.259 artifact_load_ms=1.373 artifact_parse_ms=10.155 stamp_ms=56.728 bin_ms=1.102 local_sat_ms=2.434 prop_ms=0.000 prop_iters=0 decode_ms=0.000 ctid_map_ms=0.297 filter_ms=1.044 rows_seen=15000 rows_passed=0 policy_total_ms=85.353
NOTICE:  policy_profile_query: K=0 query_id= total_ms=85.353 local_ms=60.749 prop_ms=0.000 decode_ms=0.000 sat_calls=71 cache_hits=529 closure_tables=1 filtered_targets=1
NOTICE:  policy: scan_count table=customer count=1
