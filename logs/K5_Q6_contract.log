QUERY:
SELECT COUNT(*) FROM lineitem l JOIN orders o ON l.l_orderkey=o.o_orderkey JOIN customer c ON o.o_custkey=c.c_custkey;

EXPLAIN OFF:
Aggregate
  ->  Hash Join
        Hash Cond: (l.l_orderkey = o.o_orderkey)
        ->  Index Only Scan using lineitem_l_orderkey_idx on lineitem l
        ->  Hash
              ->  Hash Join
                    Hash Cond: (o.o_custkey = c.c_custkey)
                    ->  Seq Scan on orders o
                    ->  Hash
                          ->  Seq Scan on customer c

EXPLAIN ON:
Aggregate
  ->  Hash Join
        Hash Cond: (l.l_orderkey = o.o_orderkey)
        ->  Custom Scan (custom_filter) on lineitem l
              custom_filter: 
              ->  Seq Scan on lineitem l
        ->  Hash
              ->  Hash Join
                    Hash Cond: (o.o_custkey = c.c_custkey)
                    ->  Seq Scan on orders o
                    ->  Hash
                          ->  Seq Scan on customer c

--- CONTRACT NOTICES ---
NOTICE:  policy_contract: atom y2 type=COL_CONST col=lineitem.l_discount op=3 join_class=-1 dict=dict/lineitem/l_discount dict_present=1 eval=range_evaluated vals=[0.07] toks=[-1]
NOTICE:  policy_contract: atom y3 type=COL_CONST col=lineitem.l_discount op=3 join_class=-1 dict=dict/lineitem/l_discount dict_present=1 eval=range_evaluated vals=[0.08] toks=[-1]
NOTICE:  policy_contract: atom y4 type=COL_CONST col=lineitem.l_discount op=5 join_class=-1 dict=dict/lineitem/l_discount dict_present=1 eval=range_evaluated vals=[0.02] toks=[-1]
NOTICE:  policy_contract: atom y5 type=COL_CONST col=lineitem.l_discount op=5 join_class=-1 dict=dict/lineitem/l_discount dict_present=1 eval=range_evaluated vals=[0.06] toks=[-1]
NOTICE:  policy_contract: atom y6 type=COL_CONST col=lineitem.l_extendedprice op=4 join_class=-1 dict=dict/lineitem/l_extendedprice dict_present=1 eval=range_evaluated vals=[0] toks=[-1]
NOTICE:  policy_contract: atom y7 type=COL_CONST col=lineitem.l_linestatus op=0 join_class=-1 dict=dict/lineitem/l_linestatus dict_present=1 eval=exact vals=[F] toks=[0]
NOTICE:  policy_contract: atom y8 type=COL_CONST col=lineitem.l_quantity op=3 join_class=-1 dict=dict/lineitem/l_quantity dict_present=1 eval=range_evaluated vals=[10] toks=[-1]
NOTICE:  policy_contract: atom y9 type=COL_CONST col=lineitem.l_quantity op=3 join_class=-1 dict=dict/lineitem/l_quantity dict_present=1 eval=range_evaluated vals=[15] toks=[-1]
NOTICE:  policy_contract: atom y10 type=COL_CONST col=lineitem.l_quantity op=3 join_class=-1 dict=dict/lineitem/l_quantity dict_present=1 eval=range_evaluated vals=[25] toks=[-1]
NOTICE:  policy_contract: atom y11 type=COL_CONST col=lineitem.l_quantity op=3 join_class=-1 dict=dict/lineitem/l_quantity dict_present=1 eval=range_evaluated vals=[30] toks=[-1]
NOTICE:  policy_contract: atom y12 type=COL_CONST col=lineitem.l_returnflag op=0 join_class=-1 dict=dict/lineitem/l_returnflag dict_present=1 eval=exact vals=[A] toks=[0]
NOTICE:  policy_contract: atom y13 type=COL_CONST col=lineitem.l_returnflag op=0 join_class=-1 dict=dict/lineitem/l_returnflag dict_present=1 eval=exact vals=[R] toks=[2]
NOTICE:  policy_contract: atom y14 type=COL_CONST col=lineitem.l_shipinstruct op=0 join_class=-1 dict=dict/lineitem/l_shipinstruct dict_present=1 eval=exact vals=[DELIVER IN PERSON] toks=[1]
NOTICE:  policy_contract: atom y15 type=COL_CONST col=lineitem.l_shipmode op=6 join_class=-1 dict=dict/lineitem/l_shipmode dict_present=1 eval=exact vals=[AIR,REG AIR] toks=[0,4]
NOTICE:  policy_contract: atom y16 type=COL_CONST col=lineitem.l_shipmode op=6 join_class=-1 dict=dict/lineitem/l_shipmode dict_present=1 eval=exact vals=[MAIL,SHIP] toks=[2,5]
NOTICE:  policy_contract: atom y17 type=COL_CONST col=lineitem.l_shipmode op=6 join_class=-1 dict=dict/lineitem/l_shipmode dict_present=1 eval=exact vals=[RAIL,TRUCK] toks=[3,6]
NOTICE:  policy_contract: atom y18 type=COL_CONST col=lineitem.l_tax op=3 join_class=-1 dict=dict/lineitem/l_tax dict_present=1 eval=range_evaluated vals=[0.07] toks=[-1]
NOTICE:  policy_contract: AST(lineitem)=(((((lineitem.l_shipmode IN ('AIR','REG AIR') AND lineitem.l_quantity <= 15) AND lineitem.l_discount <= 0.05) AND lineitem.l_linestatus = 'F') OR (((lineitem.l_shipmode IN ('MAIL','SHIP') AND lineitem.l_quantity <= 30) AND lineitem.l_discount <= 0.07) AND lineitem.l_returnflag = 'R')) AND lineitem.l_extendedprice > 0)
NOTICE:  policy: load_ms=4.992
NOTICE:  policy: bundle_eval target=lineitem bundle_id=5 uses_atoms=9
NOTICE:  policy: local_bins table=lineitem atoms=9 bins=1525
NOTICE:  policy: local_ms table=lineitem stamp=0.000 bin=0.000 eval=4.157 fill=1.979
NOTICE:  policy: local_eval table=lineitem sat_calls=81 cache_hits=1444
NOTICE:  policy: allow_lineitem count = 32154 / 600572
NOTICE:  policy: total_ms=19.862
NOTICE:  policy_profile: bundle=5 target=lineitem K=0 query= local={lineitem:atoms=9,bins=1525,sat=81,hits=1444,ms=0.000/0.000/4.157/1.979,total_ms=6.136} prop={iter=0,ms=0.000,classes=[]} decode={lineitem:32154/600572,ms=0.000,total_ms=0.000} total_ms=19.862
NOTICE:  custom_filter: bundle target=lineitem allow_count=2271/600572
NOTICE:  custom_filter: final_allow_lineitem count=2271/600572
NOTICE:  custom_filter: memctx label=ctid_blob rel=lineitem ptr=0x581a13f41960 mctx=0x581a13c95bb0 qctx=0x581a13c95bb0 ok=true
NOTICE:  custom_filter: allow_lineitem popcount=2271/600572
NOTICE:  custom_filter: ctid_map[0]=(0,1)->0
NOTICE:  custom_filter: ctid_map[1]=(0,2)->1
NOTICE:  custom_filter: ctid_map[2]=(0,3)->2
NOTICE:  custom_filter: ctid_map[3]=(0,4)->3
NOTICE:  custom_filter: ctid_map[4]=(0,5)->4
NOTICE:  custom_filter: memctx label=allow_bits rel=lineitem ptr=0x581a14597900 mctx=0x581a13c95bb0 qctx=0x581a13c95bb0 ok=true
NOTICE:  custom_filter: memctx label=blk_index rel=lineitem ptr=0x581a13da5e60 mctx=0x581a13c95bb0 qctx=0x581a13c95bb0 ok=true
NOTICE:  custom_filter: memctx label=ctid_hash rel=lineitem ptr=0x581a13ca7820 mctx=0x581a13ca7710 qctx=0x581a13c95bb0 ok=true
NOTICE:  custom_filter: ctid_index_ms=18.100 rel=lineitem
NOTICE:  custom_filter: lineitem_ctid head [0,1 0,2 0,3 0,4 0,5]
NOTICE:  custom_filter: retain rel=lineitem allow=75072B ctid=4804576B blk_index=135192B
NOTICE:  custom_filter: retain total allow=75072B ctid=4804576B blk_index=135192B
NOTICE:  custom_filter: allow_bits pre_exec rel=lineitem count=2271/600572 ptr=0x581a14597900 canary=ok mctx=0x581a13c95bb0 qctx=0x581a13c95bb0 qs=0x581a13c96da8
NOTICE:  custom_filter: scan rel=lineitem type=SeqScan filter=on
NOTICE:  custom_filter: allow_bits mismatch rel=lineitem allow=2271 passed=0
NOTICE:  custom_filter exec: rel=lineitem oid=74200 seen=0 passed=0 misses=0 mode=contract
NOTICE:  custom_filter: row validation time = 0.000 ms
NOTICE:  policy_metrics: eval_ms=0.211 artifact_load_ms=31.363 artifact_parse_ms=26.906 stamp_ms=2542.193 bin_ms=39.304 local_sat_ms=6.733 prop_ms=0.000 prop_iters=0 decode_ms=0.000 ctid_map_ms=18.100 filter_ms=0.000 rows_seen=0 rows_passed=0 policy_total_ms=2660.010
NOTICE:  policy_profile_query: K=0 query_id= total_ms=2660.010 local_ms=2601.588 prop_ms=0.000 decode_ms=0.000 sat_calls=126 cache_hits=7499 closure_tables=1 filtered_targets=1
NOTICE:  policy: scan_count table=lineitem count=1
NOTICE:  policy_contract: atom y2 type=COL_CONST col=lineitem.l_discount op=3 join_class=-1 dict=dict/lineitem/l_discount dict_present=1 eval=range_evaluated vals=[0.07] toks=[-1]
NOTICE:  policy_contract: atom y3 type=COL_CONST col=lineitem.l_discount op=3 join_class=-1 dict=dict/lineitem/l_discount dict_present=1 eval=range_evaluated vals=[0.08] toks=[-1]
NOTICE:  policy_contract: atom y4 type=COL_CONST col=lineitem.l_discount op=5 join_class=-1 dict=dict/lineitem/l_discount dict_present=1 eval=range_evaluated vals=[0.02] toks=[-1]
NOTICE:  policy_contract: atom y5 type=COL_CONST col=lineitem.l_discount op=5 join_class=-1 dict=dict/lineitem/l_discount dict_present=1 eval=range_evaluated vals=[0.06] toks=[-1]
NOTICE:  policy_contract: atom y6 type=COL_CONST col=lineitem.l_extendedprice op=4 join_class=-1 dict=dict/lineitem/l_extendedprice dict_present=1 eval=range_evaluated vals=[0] toks=[-1]
NOTICE:  policy_contract: atom y7 type=COL_CONST col=lineitem.l_linestatus op=0 join_class=-1 dict=dict/lineitem/l_linestatus dict_present=1 eval=exact vals=[F] toks=[0]
NOTICE:  policy_contract: atom y8 type=COL_CONST col=lineitem.l_quantity op=3 join_class=-1 dict=dict/lineitem/l_quantity dict_present=1 eval=range_evaluated vals=[10] toks=[-1]
NOTICE:  policy_contract: atom y9 type=COL_CONST col=lineitem.l_quantity op=3 join_class=-1 dict=dict/lineitem/l_quantity dict_present=1 eval=range_evaluated vals=[15] toks=[-1]
NOTICE:  policy_contract: atom y10 type=COL_CONST col=lineitem.l_quantity op=3 join_class=-1 dict=dict/lineitem/l_quantity dict_present=1 eval=range_evaluated vals=[25] toks=[-1]
NOTICE:  policy_contract: atom y11 type=COL_CONST col=lineitem.l_quantity op=3 join_class=-1 dict=dict/lineitem/l_quantity dict_present=1 eval=range_evaluated vals=[30] toks=[-1]
NOTICE:  policy_contract: atom y12 type=COL_CONST col=lineitem.l_returnflag op=0 join_class=-1 dict=dict/lineitem/l_returnflag dict_present=1 eval=exact vals=[A] toks=[0]
NOTICE:  policy_contract: atom y13 type=COL_CONST col=lineitem.l_returnflag op=0 join_class=-1 dict=dict/lineitem/l_returnflag dict_present=1 eval=exact vals=[R] toks=[2]
NOTICE:  policy_contract: atom y14 type=COL_CONST col=lineitem.l_shipinstruct op=0 join_class=-1 dict=dict/lineitem/l_shipinstruct dict_present=1 eval=exact vals=[DELIVER IN PERSON] toks=[1]
NOTICE:  policy_contract: atom y15 type=COL_CONST col=lineitem.l_shipmode op=6 join_class=-1 dict=dict/lineitem/l_shipmode dict_present=1 eval=exact vals=[AIR,REG AIR] toks=[0,4]
NOTICE:  policy_contract: atom y16 type=COL_CONST col=lineitem.l_shipmode op=6 join_class=-1 dict=dict/lineitem/l_shipmode dict_present=1 eval=exact vals=[MAIL,SHIP] toks=[2,5]
NOTICE:  policy_contract: atom y17 type=COL_CONST col=lineitem.l_shipmode op=6 join_class=-1 dict=dict/lineitem/l_shipmode dict_present=1 eval=exact vals=[RAIL,TRUCK] toks=[3,6]
NOTICE:  policy_contract: atom y18 type=COL_CONST col=lineitem.l_tax op=3 join_class=-1 dict=dict/lineitem/l_tax dict_present=1 eval=range_evaluated vals=[0.07] toks=[-1]
NOTICE:  policy_contract: AST(lineitem)=(((((lineitem.l_shipmode IN ('AIR','REG AIR') AND lineitem.l_quantity <= 15) AND lineitem.l_discount <= 0.05) AND lineitem.l_linestatus = 'F') OR (((lineitem.l_shipmode IN ('MAIL','SHIP') AND lineitem.l_quantity <= 30) AND lineitem.l_discount <= 0.07) AND lineitem.l_returnflag = 'R')) AND lineitem.l_extendedprice > 0)
NOTICE:  policy: load_ms=4.931
NOTICE:  policy: bundle_eval target=lineitem bundle_id=5 uses_atoms=9
NOTICE:  policy: local_bins table=lineitem atoms=9 bins=1525
NOTICE:  policy: local_ms table=lineitem stamp=0.000 bin=0.000 eval=4.231 fill=2.053
NOTICE:  policy: local_eval table=lineitem sat_calls=81 cache_hits=1444
NOTICE:  policy: allow_lineitem count = 32154 / 600572
NOTICE:  policy: total_ms=19.989
NOTICE:  policy_profile: bundle=5 target=lineitem K=0 query= local={lineitem:atoms=9,bins=1525,sat=81,hits=1444,ms=0.000/0.000/4.231/2.053,total_ms=6.284} prop={iter=0,ms=0.000,classes=[]} decode={lineitem:32154/600572,ms=0.000,total_ms=0.000} total_ms=19.989
NOTICE:  custom_filter: bundle target=lineitem allow_count=2271/600572
NOTICE:  custom_filter: final_allow_lineitem count=2271/600572
NOTICE:  custom_filter: memctx label=ctid_blob rel=lineitem ptr=0x581a13dddf80 mctx=0x581a13c6f700 qctx=0x581a13c6f700 ok=true
NOTICE:  custom_filter: allow_lineitem popcount=2271/600572
NOTICE:  custom_filter: ctid_map[0]=(0,1)->0
NOTICE:  custom_filter: ctid_map[1]=(0,2)->1
NOTICE:  custom_filter: ctid_map[2]=(0,3)->2
NOTICE:  custom_filter: ctid_map[3]=(0,4)->3
NOTICE:  custom_filter: ctid_map[4]=(0,5)->4
NOTICE:  custom_filter: memctx label=allow_bits rel=lineitem ptr=0x581a14585010 mctx=0x581a13c6f700 qctx=0x581a13c6f700 ok=true
NOTICE:  custom_filter: memctx label=blk_index rel=lineitem ptr=0x581a1528df40 mctx=0x581a13c6f700 qctx=0x581a13c6f700 ok=true
NOTICE:  custom_filter: memctx label=ctid_hash rel=lineitem ptr=0x581a13ca3800 mctx=0x581a13ca36f0 qctx=0x581a13c6f700 ok=true
NOTICE:  custom_filter: ctid_index_ms=17.849 rel=lineitem
NOTICE:  custom_filter: lineitem_ctid head [0,1 0,2 0,3 0,4 0,5]
NOTICE:  custom_filter: retain rel=lineitem allow=75072B ctid=4804576B blk_index=135192B
NOTICE:  custom_filter: retain total allow=75072B ctid=4804576B blk_index=135192B
NOTICE:  custom_filter: allow_bits pre_exec rel=lineitem count=2271/600572 ptr=0x581a14585010 canary=ok mctx=0x581a13c6f700 qctx=0x581a13c6f700 qs=0x581a13c708f8
NOTICE:  custom_filter: scan rel=lineitem type=SeqScan filter=on
NOTICE:  custom_filter: tid_source rel=lineitem scan=SeqScan source=tts_tid
NOTICE:  custom_filter exec: rel=lineitem oid=74200 seen=600572 passed=2271 misses=0 mode=contract
NOTICE:  custom_filter: row validation time = 57.154 ms
NOTICE:  policy_metrics: eval_ms=0.298 artifact_load_ms=26.409 artifact_parse_ms=25.076 stamp_ms=2564.053 bin_ms=38.845 local_sat_ms=6.774 prop_ms=0.000 prop_iters=0 decode_ms=0.000 ctid_map_ms=17.849 filter_ms=57.154 rows_seen=600572 rows_passed=2271 policy_total_ms=2681.614
NOTICE:  policy_profile_query: K=0 query_id= total_ms=2681.614 local_ms=2623.161 prop_ms=0.000 decode_ms=0.000 sat_calls=126 cache_hits=7499 closure_tables=1 filtered_targets=1
NOTICE:  policy: scan_count table=lineitem count=1
