SET
SET
SET
SET
SET
SET
LOAD
SET
SET
SET
SET
SET
                                                                                                                                             QUERY PLAN                                                                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate
   Output: count(*)
   ->  Sort
         Output: supplier.s_name, NULL::character varying(40)
         Sort Key: supplier.s_name
         ->  Nested Loop
               Output: supplier.s_name, NULL::character varying(40)
               Join Filter: (supplier.s_nationkey = nation.n_nationkey)
               ->  Custom Scan (custom_filter) on public.nation
                     Output: nation.n_nationkey
                     custom_filter: 
                     ->  Seq Scan on public.nation
                           Output: nation.n_nationkey
                           Filter: (nation.n_name = 'BRAZIL'::bpchar)
               ->  Nested Loop Semi Join
                     Output: supplier.s_name, supplier.s_nationkey
                     Join Filter: (supplier.s_suppkey = partsupp.ps_suppkey)
                     ->  Custom Scan (custom_filter) on public.supplier
                           Output: supplier.s_name, supplier.s_nationkey, supplier.s_suppkey
                           custom_filter: 
                           ->  Seq Scan on public.supplier
                                 Output: supplier.s_name, supplier.s_nationkey, supplier.s_suppkey
                     ->  Materialize
                           Output: partsupp.ps_suppkey
                           ->  Nested Loop Semi Join
                                 Output: partsupp.ps_suppkey
                                 Join Filter: (partsupp.ps_partkey = part.p_partkey)
                                 ->  Custom Scan (custom_filter) on public.partsupp
                                       Output: partsupp.ps_partkey, partsupp.ps_suppkey
                                       custom_filter: 
                                       ->  Seq Scan on public.partsupp
                                             Output: partsupp.ps_partkey, partsupp.ps_suppkey
                                             Filter: ((partsupp.ps_availqty)::numeric > (SubPlan 1))
                                             SubPlan 1
                                               ->  Aggregate
                                                     Output: (0.5 * sum(lineitem.l_quantity))
                                                     ->  Custom Scan (custom_filter) on public.lineitem
                                                           Output: lineitem.l_quantity
                                                           custom_filter: 
                                                           ->  Seq Scan on public.lineitem
                                                                 Output: lineitem.l_quantity
                                                                 Filter: ((lineitem.l_shipdate >= '1995-01-01'::date) AND (lineitem.l_shipdate < '1996-01-01 00:00:00'::timestamp without time zone) AND (lineitem.l_partkey = partsupp.ps_partkey) AND (lineitem.l_suppkey = partsupp.ps_suppkey))
                                 ->  Materialize
                                       Output: part.p_partkey
                                       ->  Custom Scan (custom_filter) on public.part
                                             Output: part.p_partkey
                                             custom_filter: 
                                             ->  Seq Scan on public.part
                                                   Output: part.p_partkey
                                                   Filter: ((part.p_name)::text ~~ 'midnight%'::text)
(50 rows)

