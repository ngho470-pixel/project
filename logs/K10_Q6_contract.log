QUERY:
SELECT COUNT(*) FROM lineitem l JOIN orders o ON l.l_orderkey=o.o_orderkey JOIN customer c ON o.o_custkey=c.c_custkey;

EXPLAIN OFF:
Aggregate
  ->  Hash Join
        Hash Cond: (l.l_orderkey = o.o_orderkey)
        ->  Index Only Scan using lineitem_l_orderkey_idx on lineitem l
        ->  Hash
              ->  Hash Join
                    Hash Cond: (o.o_custkey = c.c_custkey)
                    ->  Seq Scan on orders o
                    ->  Hash
                          ->  Seq Scan on customer c

EXPLAIN ON:
Aggregate
  ->  Hash Join
        Hash Cond: (l.l_orderkey = o.o_orderkey)
        ->  Custom Scan (custom_filter) on lineitem l
              custom_filter: 
              ->  Seq Scan on lineitem l
        ->  Hash
              ->  Hash Join
                    Hash Cond: (o.o_custkey = c.c_custkey)
                    ->  Seq Scan on orders o
                    ->  Hash
                          ->  Custom Scan (custom_filter) on customer c
                                custom_filter: 
                                ->  Seq Scan on customer c

--- CONTRACT NOTICES ---
NOTICE:  policy: bundle_eval target=customer bundle_id=10 uses_atoms=7
NOTICE:  policy: local_bins table=customer atoms=7 bins=120
NOTICE:  policy: local_ms table=customer stamp=0.000 bin=0.000 eval=1.503 fill=0.063
NOTICE:  policy: local_eval table=customer sat_calls=32 cache_hits=88
NOTICE:  policy: allow_customer count = 1244 / 15000
NOTICE:  policy: total_ms=11.781
NOTICE:  policy_profile: bundle=10 target=customer K=0 query= local={customer:atoms=7,bins=120,sat=32,hits=88,ms=0.000/0.000/1.503/0.063,total_ms=1.566} prop={iter=0,ms=0.000,classes=[]} decode={customer:1244/15000,ms=0.000,total_ms=0.000} total_ms=11.781
NOTICE:  custom_filter: bundle target=customer allow_count=0/15000
NOTICE:  custom_filter: final_allow_lineitem count=2271/600572
NOTICE:  custom_filter: final_allow_customer count=0/15000
NOTICE:  custom_filter: memctx label=ctid_blob rel=customer ptr=0x581a13cee2f0 mctx=0x581a13c993e0 qctx=0x581a13c993e0 ok=true
NOTICE:  custom_filter: allow_customer popcount=0/15000
NOTICE:  custom_filter: ctid_map[0]=(0,1)->0
NOTICE:  custom_filter: ctid_map[1]=(0,2)->1
NOTICE:  custom_filter: ctid_map[2]=(0,3)->2
NOTICE:  custom_filter: ctid_map[3]=(0,4)->3
NOTICE:  custom_filter: ctid_map[4]=(0,5)->4
NOTICE:  custom_filter: memctx label=allow_bits rel=customer ptr=0x581a1477e1f0 mctx=0x581a13c993e0 qctx=0x581a13c993e0 ok=true
NOTICE:  custom_filter: memctx label=blk_index rel=customer ptr=0x581a1477e9f8 mctx=0x581a13c993e0 qctx=0x581a13c993e0 ok=true
NOTICE:  custom_filter: memctx label=ctid_hash rel=customer ptr=0x581a13cab050 mctx=0x581a13caaf40 qctx=0x581a13c993e0 ok=true
NOTICE:  custom_filter: ctid_index_ms=0.314 rel=customer
NOTICE:  custom_filter: customer_ctid head [0,1 0,2 0,3 0,4 0,5]
NOTICE:  custom_filter: retain rel=customer allow=1875B ctid=120000B blk_index=4332B
NOTICE:  custom_filter: memctx label=ctid_blob rel=lineitem ptr=0x581a13fb1a30 mctx=0x581a13c993e0 qctx=0x581a13c993e0 ok=true
NOTICE:  custom_filter: allow_lineitem popcount=2271/600572
NOTICE:  custom_filter: ctid_map[0]=(0,1)->0
NOTICE:  custom_filter: ctid_map[1]=(0,2)->1
NOTICE:  custom_filter: ctid_map[2]=(0,3)->2
NOTICE:  custom_filter: ctid_map[3]=(0,4)->3
NOTICE:  custom_filter: ctid_map[4]=(0,5)->4
NOTICE:  custom_filter: memctx label=allow_bits rel=lineitem ptr=0x581a13ddd5a0 mctx=0x581a13c993e0 qctx=0x581a13c993e0 ok=true
NOTICE:  custom_filter: memctx label=blk_index rel=lineitem ptr=0x581a13e388e0 mctx=0x581a13c993e0 qctx=0x581a13c993e0 ok=true
NOTICE:  custom_filter: memctx label=ctid_hash rel=lineitem ptr=0x581a13caf070 mctx=0x581a13caef60 qctx=0x581a13c993e0 ok=true
NOTICE:  custom_filter: ctid_index_ms=19.182 rel=lineitem
NOTICE:  custom_filter: lineitem_ctid head [0,1 0,2 0,3 0,4 0,5]
NOTICE:  custom_filter: retain rel=lineitem allow=75072B ctid=4804576B blk_index=135192B
NOTICE:  custom_filter: retain total allow=76947B ctid=4924576B blk_index=139524B
NOTICE:  custom_filter: allow_bits pre_exec rel=customer count=0/15000 ptr=0x581a1477e1f0 canary=ok mctx=0x581a13c993e0 qctx=0x581a13c993e0 qs=0x581a13c9a5d8
NOTICE:  custom_filter: allow_bits pre_exec rel=lineitem count=2271/600572 ptr=0x581a13ddd5a0 canary=ok mctx=0x581a13c993e0 qctx=0x581a13c993e0 qs=0x581a13c9a5d8
NOTICE:  custom_filter: scan rel=lineitem type=SeqScan filter=on
NOTICE:  custom_filter: scan rel=customer type=SeqScan filter=on
NOTICE:  custom_filter: allow_bits mismatch rel=lineitem allow=2271 passed=0
NOTICE:  custom_filter exec: rel=lineitem oid=74200 seen=0 passed=0 misses=0 mode=contract
NOTICE:  custom_filter: row validation time = 0.000 ms
NOTICE:  custom_filter exec: rel=customer oid=74194 seen=0 passed=0 misses=0 mode=contract
NOTICE:  custom_filter: row validation time = 0.000 ms
NOTICE:  policy_metrics: eval_ms=0.691 artifact_load_ms=32.326 artifact_parse_ms=72.358 stamp_ms=2616.214 bin_ms=41.100 local_sat_ms=12.918 prop_ms=0.000 prop_iters=0 decode_ms=0.000 ctid_map_ms=19.497 filter_ms=0.000 rows_seen=0 rows_passed=0 policy_total_ms=2802.906
NOTICE:  policy_profile_query: K=0 query_id= total_ms=2802.906 local_ms=2684.146 prop_ms=0.000 decode_ms=0.000 sat_calls=197 cache_hits=8028 closure_tables=2 filtered_targets=1
NOTICE:  policy: scan_count table=customer count=1
NOTICE:  policy: scan_count table=lineitem count=1
NOTICE:  policy: local_ms table=customer stamp=0.000 bin=0.000 eval=1.493 fill=0.079
NOTICE:  policy: local_eval table=customer sat_calls=32 cache_hits=88
NOTICE:  policy: allow_customer count = 1244 / 15000
NOTICE:  policy: total_ms=11.567
NOTICE:  policy_profile: bundle=10 target=customer K=0 query= local={customer:atoms=7,bins=120,sat=32,hits=88,ms=0.000/0.000/1.493/0.079,total_ms=1.571} prop={iter=0,ms=0.000,classes=[]} decode={customer:1244/15000,ms=0.000,total_ms=0.000} total_ms=11.567
NOTICE:  custom_filter: bundle target=customer allow_count=0/15000
NOTICE:  custom_filter: final_allow_lineitem count=2271/600572
NOTICE:  custom_filter: final_allow_customer count=0/15000
NOTICE:  custom_filter: memctx label=ctid_blob rel=customer ptr=0x581a13ced050 mctx=0x581a13c6ff20 qctx=0x581a13c6ff20 ok=true
NOTICE:  custom_filter: allow_customer popcount=0/15000
NOTICE:  custom_filter: ctid_map[0]=(0,1)->0
NOTICE:  custom_filter: ctid_map[1]=(0,2)->1
NOTICE:  custom_filter: ctid_map[2]=(0,3)->2
NOTICE:  custom_filter: ctid_map[3]=(0,4)->3
NOTICE:  custom_filter: ctid_map[4]=(0,5)->4
NOTICE:  custom_filter: memctx label=allow_bits rel=customer ptr=0x581a13edb120 mctx=0x581a13c6ff20 qctx=0x581a13c6ff20 ok=true
NOTICE:  custom_filter: memctx label=blk_index rel=customer ptr=0x581a13edb928 mctx=0x581a13c6ff20 qctx=0x581a13c6ff20 ok=true
NOTICE:  custom_filter: memctx label=ctid_hash rel=customer ptr=0x581a13ca5020 mctx=0x581a13ca4f10 qctx=0x581a13c6ff20 ok=true
NOTICE:  custom_filter: ctid_index_ms=0.324 rel=customer
NOTICE:  custom_filter: customer_ctid head [0,1 0,2 0,3 0,4 0,5]
NOTICE:  custom_filter: retain rel=customer allow=1875B ctid=120000B blk_index=4332B
NOTICE:  custom_filter: memctx label=ctid_blob rel=lineitem ptr=0x581a13fb1450 mctx=0x581a13c6ff20 qctx=0x581a13c6ff20 ok=true
NOTICE:  custom_filter: allow_lineitem popcount=2271/600572
NOTICE:  custom_filter: ctid_map[0]=(0,1)->0
NOTICE:  custom_filter: ctid_map[1]=(0,2)->1
NOTICE:  custom_filter: ctid_map[2]=(0,3)->2
NOTICE:  custom_filter: ctid_map[3]=(0,4)->3
NOTICE:  custom_filter: ctid_map[4]=(0,5)->4
NOTICE:  custom_filter: memctx label=allow_bits rel=lineitem ptr=0x581a15047a30 mctx=0x581a13c6ff20 qctx=0x581a13c6ff20 ok=true
NOTICE:  custom_filter: memctx label=blk_index rel=lineitem ptr=0x581a14f0fc00 mctx=0x581a13c6ff20 qctx=0x581a13c6ff20 ok=true
NOTICE:  custom_filter: memctx label=ctid_hash rel=lineitem ptr=0x581a13ca7030 mctx=0x581a13ca6f20 qctx=0x581a13c6ff20 ok=true
NOTICE:  custom_filter: ctid_index_ms=17.567 rel=lineitem
NOTICE:  custom_filter: lineitem_ctid head [0,1 0,2 0,3 0,4 0,5]
NOTICE:  custom_filter: retain rel=lineitem allow=75072B ctid=4804576B blk_index=135192B
NOTICE:  custom_filter: retain total allow=76947B ctid=4924576B blk_index=139524B
NOTICE:  custom_filter: allow_bits pre_exec rel=customer count=0/15000 ptr=0x581a13edb120 canary=ok mctx=0x581a13c6ff20 qctx=0x581a13c6ff20 qs=0x581a13c71118
NOTICE:  custom_filter: allow_bits pre_exec rel=lineitem count=2271/600572 ptr=0x581a15047a30 canary=ok mctx=0x581a13c6ff20 qctx=0x581a13c6ff20 qs=0x581a13c71118
NOTICE:  custom_filter: scan rel=lineitem type=SeqScan filter=on
NOTICE:  custom_filter: scan rel=customer type=SeqScan filter=on
NOTICE:  custom_filter: tid_source rel=lineitem scan=SeqScan source=tts_tid
NOTICE:  custom_filter: tid_source rel=customer scan=SeqScan source=tts_tid
NOTICE:  custom_filter: allow_bits mismatch rel=lineitem allow=2271 passed=1
NOTICE:  custom_filter exec: rel=lineitem oid=74200 seen=313 passed=1 misses=0 mode=contract
NOTICE:  custom_filter: row validation time = 0.047 ms
NOTICE:  custom_filter exec: rel=customer oid=74194 seen=15000 passed=0 misses=0 mode=contract
NOTICE:  custom_filter: row validation time = 1.073 ms
NOTICE:  policy_metrics: eval_ms=0.389 artifact_load_ms=27.803 artifact_parse_ms=69.381 stamp_ms=2627.152 bin_ms=39.829 local_sat_ms=12.823 prop_ms=0.000 prop_iters=0 decode_ms=0.000 ctid_map_ms=17.891 filter_ms=1.120 rows_seen=15313 rows_passed=1 policy_total_ms=2810.871
NOTICE:  policy_profile_query: K=0 query_id= total_ms=2810.871 local_ms=2693.663 prop_ms=0.000 decode_ms=0.000 sat_calls=197 cache_hits=8028 closure_tables=2 filtered_targets=1
NOTICE:  policy: scan_count table=customer count=1
NOTICE:  policy: scan_count table=lineitem count=1
